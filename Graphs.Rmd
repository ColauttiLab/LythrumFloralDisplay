---
title: "Floral Display Graphs"
author: "Dale Moskoff"
date: "22/04/2021"
output: html_document
---

# Setup

```{r data setup}
dat<-read.csv("./FloralDisplayPop.csv") # Latitudes of population origin were added to the csv file manually.
library(ggplot2)
library(dplyr)

theme_custom<-function(base_size = 24, base_family = ""){
  theme_bw(base_size = base_size, base_family = base_family) %+replace% 
    theme(axis.text = element_text(size = rel(0.8),colour="black"),
          axis.ticks = element_line(colour = "black"), 
          legend.position = "none",
          panel.border = element_rect(fill = NA, colour = NA), 
          panel.grid.major = element_line(colour = NA,size = 0), 
          panel.grid.minor = element_line(colour = NA,size = 0), 
          axis.line = element_line(colour ="black")
    )
}
```

# Common Metrics

```{r}
#Julian day first flower x Latitude
FirstFlwr<- ggplot(data=dat,mapping=aes(x=Latitude,y=Start)) + geom_point() + labs(x="Latitude",y="Day",title="Day of first flower") + theme_custom() + geom_smooth(method = "lm", se=F, colour="red")

FirstFlwr

reg4<-lm(Start~Latitude,data=dat)
summary(reg4)

#Duration x Latitude
Duration<- ggplot() + geom_point(data=dat,mapping=aes(x=Latitude,y=Duration)) + labs(x="Latitude",y="Days",title="Floweirng Duration") + theme_custom()

Duration

reg5<-lm(Duration~Latitude,data=dat)
summary(reg5)

#End Date x Latitude
EndDate<-ggplot(data=dat,mapping=aes(x=Latitude,y=End)) + geom_point() + labs(x="Latitude",y="Day",title="Last day of flowering") + theme_custom() + geom_smooth(method = "lm", se=F, colour="red")

EndDate

reg6<-lm(End~Latitude,data=dat)
summary(reg6)

```



# Standardized Curve

(Area under flowering schedule curve = 1)

```{r standardized data graphs}
# Peak (mean) flowering x Latitude
Peak <- ggplot(data=dat,mapping=aes(x=Latitude,y=Peak)) + geom_point() + labs(x="Latitude",y="Peak",title="Peak flowering") + theme_custom() + geom_smooth(method = "lm", se=F, colour="red")

Peak

reg0<-lm(Peak~Latitude,data=dat)
summary(reg0)

# Variance x Latitude
VarST<- ggplot(data=dat,mapping=aes(x=Latitude,y=Var)) + geom_point() + labs(x="Latitude",y="Variance",title="Variance of flowering schedule") + theme_custom() + geom_smooth(method = "lm", se=F, colour="red")

VarST

reg1<-lm(Var~Latitude,data=dat)
summary(reg1)

#Skew x Latitude
SkewST<- ggplot(data=dat,mapping=aes(x=Latitude,y=Skew)) + geom_point() + labs(x="Latitude",y="Skew Coef",title="Skewness of Flowering Schedule") + theme_custom()

SkewST

reg2<-lm(Skew~Latitude,data=dat)
summary(reg2)

#Kurtosis x Latitude
KurtST<- ggplot(data=dat,mapping=aes(x=Latitude,y=Kurt)) + geom_point() + labs(x="Latitude",y="Kurtosis Coef",title="Kurtosis of Flowering Schedule") + theme_custom()

KurtST

reg3<-lm(Kurt~Latitude,data=dat)
summary(reg3)
```

